{
  "tests": [
    {
      "name": "Adapt template with contacts and CTA",
      "method": "POST",
      "path": "/",
      "body": {
        "action": "adapt",
        "html": "<!DOCTYPE html><html><body><h1>Welcome Event</h1><p>Contact us: <a href=\"mailto:test@example.com\">test@example.com</a> or call +7 999 123-45-67</p><a href=\"https://example.com/register\" style=\"background:#007bff;padding:10px;border-radius:5px;\">Register Now</a></body></html>",
        "options": {}
      },
      "expectedStatus": 200,
      "expectedBody": {
        "stats": {
          "cta_count": 1
        }
      },
      "bodyMatcher": "partial"
    },
    {
      "name": "Render with Knowledge Store auto-fill",
      "method": "POST",
      "path": "/",
      "body": {
        "action": "render",
        "template": "<h1>{{title}}</h1><p>{{preheader}}</p><a href=\"{{cta_top_url}}\">{{cta_top_text}}</a><p>Contact: {{brand.support}}</p>",
        "data": {
          "title": "Special Event"
        },
        "eventId": "test-event-123"
      },
      "expectedStatus": 200,
      "expectedBody": {
        "rendered_html": "string",
        "plain_text": "string",
        "utm_applied": true,
        "meta": {
          "preheader": "string"
        }
      },
      "bodyMatcher": "partial"
    },
    {
      "name": "Get knowledge data",
      "method": "POST",
      "path": "/",
      "body": {
        "action": "knowledge",
        "eventId": "test-event"
      },
      "expectedStatus": 200,
      "expectedBody": {
        "brand": {
          "support": "string"
        },
        "defaults": {
          "preheader": "string"
        }
      },
      "bodyMatcher": "partial"
    },
    {
      "name": "Detect repeating speaker blocks",
      "method": "POST",
      "path": "/",
      "body": {
        "action": "adapt",
        "html": "<html><body><h1>Event</h1><div><div><h3>John Doe</h3><p>CEO</p><span>Future of Tech</span></div><div><h3>Jane Smith</h3><p>CTO</p><span>AI Revolution</span></div><div><h3>Bob Johnson</h3><p>VP</p><span>Cloud Computing</span></div></div></body></html>",
        "options": {}
      },
      "expectedStatus": 200,
      "expectedBody": {
        "stats": {
          "collection_placeholders": 1
        }
      },
      "bodyMatcher": "partial"
    }
  ]
}
