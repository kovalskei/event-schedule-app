<!DOCTYPE html>
<html>
<head>
    <title>Template Generator Test</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        button {
            background: #667eea;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
        }
        button:hover {
            background: #764ba2;
        }
        .result {
            background: #f5f5f5;
            padding: 16px;
            border-radius: 8px;
            margin-top: 16px;
            white-space: pre-wrap;
            word-break: break-word;
        }
        .check {
            margin-top: 20px;
            padding: 16px;
            border-radius: 8px;
        }
        .pass { background: #d4edda; border: 1px solid #c3e6cb; }
        .fail { background: #f8d7da; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>
    <h1>üß™ Template Generator Test</h1>
    <button onclick="testConversion()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
    <div id="output"></div>

    <script>
        const testHTML = `<!DOCTYPE html>
<html>
<head>
<style>
.gradient-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 40px;
}
.stats-card {
    border: 2px solid #e5e7eb;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
</style>
</head>
<body>
<table width="600" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
  <tr>
    <td style="padding: 40px; text-align: center;">
      <h1 style="color: #ffffff; font-size: 32px; margin: 0;">–†–µ–≤–æ–ª—é—Ü–∏—è –≤ HR-–ø–æ–¥–±–æ—Ä–µ</h1>
      <p style="color: #f3f4f6; font-size: 18px; margin-top: 16px;">
        –£–≤–µ–ª–∏—á—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞–π–º–∞ –Ω–∞ 300% —Å –ø–æ–º–æ—â—å—é –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
      </p>
    </td>
  </tr>
</table>

<table width="600" style="margin-top: 32px;">
  <tr>
    <td class="stats-card" style="padding: 24px; border: 2px solid #e5e7eb; border-radius: 12px;">
      <h2 style="color: #1f2937; font-size: 48px; margin: 0;">2,500+</h2>
      <p style="color: #6b7280; font-size: 16px;">HR-–º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç</p>
    </td>
  </tr>
</table>

<table width="600" style="margin-top: 24px;">
  <tr>
    <td style="text-align: center; padding: 16px;">
      <a href="https://example.com/demo" style="background: linear-gradient(90deg, #667eea, #764ba2); color: white; padding: 16px 32px; border-radius: 8px; text-decoration: none; display: inline-block; font-weight: bold;">
        –ù–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ
      </a>
    </td>
  </tr>
</table>
</body>
</html>`;

        async function testConversion() {
            const output = document.getElementById('output');
            output.innerHTML = '<div class="result">‚è≥ –û—Ç–ø—Ä–∞–≤–ª—è—é –∑–∞–ø—Ä–æ—Å...</div>';

            try {
                const response = await fetch('https://functions.poehali.dev/616d6890-24c3-49c8-8b29-692dd342933b', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        html_content: testHTML
                    })
                });

                const data = await response.json();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                const checks = [];
                const template = data.template_content || '';

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –ì—Ä–∞–¥–∏–µ–Ω—Ç –≤ —Å—Ç–∏–ª—è—Ö (135deg)
                const hasStyleGradient = template.includes('linear-gradient(135deg, #667eea 0%, #764ba2 100%)');
                checks.push({
                    name: '–ì—Ä–∞–¥–∏–µ–Ω—Ç –≤ <style> (135deg)',
                    passed: hasStyleGradient
                });

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ì—Ä–∞–¥–∏–µ–Ω—Ç inline –≤ table (135deg)
                const hasTableGradient = template.includes('style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)');
                checks.push({
                    name: '–ì—Ä–∞–¥–∏–µ–Ω—Ç –≤ table inline (135deg)',
                    passed: hasTableGradient
                });

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –ì—Ä–∞–¥–∏–µ–Ω—Ç –≤ —Å—Å—ã–ª–∫–µ (90deg)
                const hasLinkGradient = template.includes('linear-gradient(90deg, #667eea, #764ba2)');
                checks.push({
                    name: '–ì—Ä–∞–¥–∏–µ–Ω—Ç –≤ —Å—Å—ã–ª–∫–µ (90deg)',
                    passed: hasLinkGradient
                });

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ 4: box-shadow
                const hasBoxShadow = template.includes('box-shadow: 0 4px 6px rgba(0,0,0,0.1)');
                checks.push({
                    name: 'box-shadow —Å–æ—Ö—Ä–∞–Ω—ë–Ω',
                    passed: hasBoxShadow
                });

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ 5: border-radius
                const hasBorderRadius = template.includes('border-radius: 12px');
                checks.push({
                    name: 'border-radius —Å–æ—Ö—Ä–∞–Ω—ë–Ω',
                    passed: hasBorderRadius
                });

                // –§–æ—Ä–º–∏—Ä—É–µ–º –≤—ã–≤–æ–¥
                let html = '<h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:</h2>';
                checks.forEach(check => {
                    html += `<div class="check ${check.passed ? 'pass' : 'fail'}">
                        ${check.passed ? '‚úÖ' : '‚ùå'} ${check.name}
                    </div>`;
                });

                const allPassed = checks.every(c => c.passed);
                html += `<h3>${allPassed ? 'üéâ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã!' : '‚ö†Ô∏è –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã'}</h3>`;

                html += '<h2>üìÑ –ü–æ–ª–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h2>';
                html += `<div class="result">${JSON.stringify(data, null, 2)}</div>`;

                output.innerHTML = html;

            } catch (error) {
                output.innerHTML = `<div class="result">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>
